# DLL调试

在一个大型项目中，有可能部分代码使用C语言编写，而另外一部分代码使用LabVIEW语言编写。这种混合编程方式是非常常见的。

## 调试LabVIEW调用的DLL

在项目中，最常用的混合编程方式是使用LabVIEW编写程序界面，用VC编写某些算法和数据采集部分。C语言部分的代码被编译成DLL文件，在LabVIEW中通过CLN节点调用这些DLL文件中的函数。有些用C语言编写的函数中可能存在某些错误，只有当它们在LabVIEW程序中被调用时才会显现出来。这就要求在LabVIEW程序运行时，调试这些DLL函数。

调试C语言的代码还是要在VC的编程环境中调试。对于生成可执行文件的C程序，在代码中设置断点再运行，程序即可暂停在断点处，然后进行单步调试等。对于生成的DLL也可以使用类似方法进行调试。

由于DLL是不能直接运行的，所以要让VC调用LabVIEW，才能进行调试。设置的方法是在VC项目的属性中，设置"Debugging-\>Command"为LabVIEW.exe可执行文件（图
8.41）。

![](images/image530.png)

图 .41设置VC中的调试命令

设置好调试命令，再在VC中点击"开始调试"按钮或菜单，VC就会把LabVIEW调用起来。如果代码中有断点，程序会暂停在断点处。

使用这种调试方法时，需要注意：被调试的DLL应当处于调试模式下。并且，在开发调试过程中，计算机内可能存有多份不同版本的这一DLL文件。要确保LabVIEW调用的DLL确实是当前正在调试的版本。

## 调试LabVIEW生成的DLL

另一种LabVIEW与C语言混合编程的模式是使用C语言编写高层部分，如界面等。使用LabVIEW完成底层部分，如数据采集、分析。这一使用方法与上节所提到的恰好相反，需要调试的代码部分也正好相反。在这种模式下可能会遇到的调试需求是，当C语言程序调用LabVIEW生成的DLL时，DLL中的函数出现了错误，需要调试LabVIEW代码才能找出错误根源。

这类调试比较容易进行。只要在LabVIEW生成DLL的时候在VI中设置断点，程序运行至断点处就会暂停下来，并且打开断点所在的VI。接下来可以使用一般调试VI的方法进行调试即可。